name: fwforti
  
topology:
  nodes:

    router-lan:
      kind: cisco_iol
      image: docker.io/arthurk99/cisco-iol:17.15.01 
      startup-config: configs/router/config.partial

    router-wan:
      kind: cisco_iol
      image: docker.io/arthurk99/cisco-iol:17.15.01 
      startup-config: configs/router-wan1/configw1.partial
              
    srlswitch:
      kind: nokia_srlinux
      image: ghcr.io/nokia/srlinux:24.10.1
      type: ixrd3
      startup-config: configs/switch/srlswitch.cfg
    
    # Fortigate FW
    fw:
      kind: vr-fortios
      image: vrnetlab/vr-fortios:6.0.3
      env:
        QEMU_SMP: 1
        QEMU_MEMORY: 1024
      ports:
        - 80:80
        - 443:443
    
    PC1: 
      kind: linux # "Alpine Linux v3.12"
      image: ghcr.io/hellt/network-multitool
      binds:
       - configs/client.sh:/root/client.sh
      exec:
       - ip -6 route del default dev eth0
       - chmod +x /root/client.sh
       - bash /root/client.sh
       - ip route del default dev eth0

    PC2: 
      kind: linux # "Alpine Linux v3.12"
      image: ghcr.io/hellt/network-multitool
      binds:
       - configs/client.sh:/root/client.sh
      exec:
       - ip -6 route del default dev eth0
       - chmod +x /root/client.sh
       - bash /root/client.sh
       - ip route del default dev eth0

    PC3: 
      kind: linux # "Alpine Linux v3.12"
      image: ghcr.io/hellt/network-multitool
      binds:
       - configs/client-remote.sh:/root/client-remote.sh
      exec:
        - chmod +x /root/client-remote.sh
        - bash /root/client-remote.sh 
        - ip -6 route del default dev eth0
        - ip route del default dev eth0
        - ip -4 addr add 10.20.0.10/24 dev eth1
        - ip route add default via 10.20.0.1    
       
    srvweb-lan:
       kind: linux
       image: docker.io/esanchezv/srvhttps:latest
       binds:
        #- config/serverweb.sh:/root/serverweb.sh
        - configs/web-server.html:/var/www/localhost/htdocs/index.html
       exec:
        - ip route del default dev eth0       
        - ip -6 route del default dev eth0
        - ip -4 addr add 172.16.0.10/24 dev eth1
        - ip route add default dev eth1    
  links:
    - endpoints: ["router-wan:Ethernet0/2","PC3:eth1"]
    - endpoints: ["router-wan:Ethernet0/1","fw:eth2"]
    - endpoints: ["srvweb-lan:eth1","fw:eth3"]
    - endpoints: ["router-lan:Ethernet0/1","fw:eth1"]
    - endpoints: ["router-lan:Ethernet0/2","srlswitch:e1-1"]    
    - endpoints: ["PC1:eth1","srlswitch:e1-2"]
      mtu: 1500
    - endpoints: ["PC2:eth1","srlswitch:e1-3"]
      mtu: 1500  
